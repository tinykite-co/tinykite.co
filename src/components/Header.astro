---
import ThemeToggle from "./ThemeToggle.astro";

const currentPath = Astro.url.pathname;
---

<header
  id="site-header"
  class="fixed top-6 md:top-8 left-1/2 -translate-x-1/2 z-50 w-[92%] md:w-[85%] 
  rounded-full bg-gradient-to-r from-gray-800/90 to-gray-700/90 
  dark:from-dark/90 dark:to-dark-light/90 backdrop-blur-md 
  border border-white/10 shadow-lg transition-all duration-500"
>
  <nav class="flex items-center justify-between px-6 py-4">
    <!-- ✅ Logo -->
    <a href="/" class="flex items-center gap-2">
      <img src="/tinykite-logo.svg" alt="TinyKite Logo" class="w-6 h-6" />
      <span class="text-xl font-semibold text-white tracking-tight">TinyKite</span>
    </a>

    <!-- ✅ Desktop Navigation -->
    <div class="hidden md:flex items-center space-x-8">
      <a
        href="/"
        class:list={[
          "hover:text-indigo-400 transition-colors text-gray-300",
          currentPath === "/" ? "text-indigo-400 font-medium" : "",
        ]}
      >
        Ecosystem
      </a>
      <a
        href="/blog"
        class:list={[
          "hover:text-indigo-400 transition-colors text-gray-300",
          currentPath.startsWith("/blog") ? "text-indigo-400 font-medium" : "",
        ]}
      >
        Innovation
      </a>
      <a
        href="/about"
        class:list={[
          "hover:text-indigo-400 transition-colors text-gray-300",
          currentPath === "/about" ? "text-indigo-400 font-medium" : "",
        ]}
      >
        About
      </a>
      <a
        href="/blog"
        class:list={[
          "hover:text-indigo-400 transition-colors text-gray-300",
          currentPath.startsWith("/blog") ? "text-indigo-400 font-medium" : "",
        ]}
      >
        Blog
      </a>
    </div>

    <!-- ✅ Actions (Join Us + Theme + Mobile) -->
    <div class="flex items-center space-x-4">
      <a
        href="/about"
        class="hidden md:inline-block px-5 py-2 rounded-full text-white font-medium text-sm
        bg-gradient-to-r from-indigo-600/90 to-blue-500/90 hover:from-indigo-500 hover:to-blue-400
        border border-white/10 shadow-sm transition-all duration-300 hover:scale-105"
      >
        Join Us
      </a>

      <ThemeToggle />

      <!-- Mobile Menu Button -->
      <button
        id="mobile-menu-toggle"
        class="md:hidden p-2 rounded-lg bg-white/10 text-gray-200 hover:bg-white/20 transition-all duration-300"
        aria-label="Toggle menu"
      >
        <svg
          id="menu-icon"
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="2"
          stroke="currentColor"
          class="w-6 h-6"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M4 6h16M4 12h16M4 18h16"
          />
        </svg>
      </button>
    </div>
  </nav>

  <!-- ✅ Mobile Menu -->
  <div
    id="mobile-menu"
    class="hidden md:hidden flex flex-col items-center gap-4 py-5 border-t border-white/10 
    bg-gray-800/90 dark:bg-dark/90 rounded-b-3xl transition-all duration-300"
  >
    <a href="/" class="text-gray-200 hover:text-indigo-400 text-base">Ecosystem</a>
    <a href="/blog" class="text-gray-200 hover:text-indigo-400 text-base">Innovation</a>
    <a href="/about" class="text-gray-200 hover:text-indigo-400 text-base">About</a>
    <a href="/blog" class="text-gray-200 hover:text-indigo-400 text-base">Blog</a>
    <a
      href="/about"
      class="px-6 py-2 rounded-full text-white font-medium text-sm bg-gradient-to-r
      from-indigo-600/90 to-blue-500/90 hover:from-indigo-500 hover:to-blue-400
      border border-white/10 shadow-sm transition-all duration-300 hover:scale-105"
    >
      Join Us
    </a>
  </div>
</header>

<style>
  #site-header.scrolled {
    background: rgba(31, 41, 55, 0.95);
    border-color: rgba(255, 255, 255, 0.1);
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.25);
    transform: scale(0.995);
  }
</style>

<script>
  const header = document.getElementById("site-header");
  const mobileMenuToggle = document.getElementById("mobile-menu-toggle");
  const mobileMenu = document.getElementById("mobile-menu");
  const menuIcon = document.getElementById("menu-icon");

  // Toggle mobile menu
  mobileMenuToggle?.addEventListener("click", () => {
    mobileMenu?.classList.toggle("hidden");

    if (menuIcon.getAttribute("data-open") === "true") {
      menuIcon.setAttribute("data-open", "false");
      menuIcon.innerHTML =
        '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>';
    } else {
      menuIcon.setAttribute("data-open", "true");
      menuIcon.innerHTML =
        '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>';
    }
  });

  // Header scroll effect
  window.addEventListener("scroll", () => {
    if (window.scrollY > 10) {
      header.classList.add("scrolled");
    } else {
      header.classList.remove("scrolled");
    }
  });
</script>
